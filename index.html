<!DOCTYPE html>
<html lang="fr" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simulateur TNS & IR ‚Äì CA ‚Üí R (France) ‚Ä¢ v12.2</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="topbar" id="topbar">
    <div class="container">
      <div style="font-weight:700">Simulateur TNS & IR ‚Ä¢ v1.1</div>
      <div class="actions">
        <div class="pill">
          <label for="modeSel">Mode r√©mun√©ration</label>
          <select id="modeSel" onchange="switchMode(this.value)">
            <option value="tns" selected>EURL/EI √† l‚ÄôIS (TNS)</option>
            <option value="sasuIR">SASU √† l‚ÄôIR (transparence)</option>
            <option value="sasuIS">SASU √† l‚ÄôIS (salaire + dividendes)</option>
          </select>
        </div>
        <div class="pill">
          <label for="themeSel">Th√®me</label>
          <select id="themeSel" onchange="applyTheme(this.value)">
            <option value="dark" selected>Sombre</option>
            <option value="light">Clair</option>
            <option value="auto">Auto (OS)</option>
          </select>
          </div>
          <div class="pill">
          <label for="roundSel" style="margin-left:8px">Arr.</label>
          <select id="roundSel" onchange="applyRounding(this.value)" style="min-width:70px">
            <option value="disp0" selected>0&nbsp;‚Ç¨</option>
            <option value="disp2">2&nbsp;d√©c.</option>
          </select>
        </div>
        <div class="pill">
          <label for="viewMode">Affichage</label>
          <select id="viewMode" onchange="toggleViewMode(this.value)">
            <option value="auto" selected>Auto</option>
            <option value="mobile">Mobile</option>
            <option value="desktop">Ordinateur</option>
          </select>
        </div>
        <!-- <div class="pill">
          <label for="compactToggle">Dense</label>
          <select id="compactToggle" onchange="toggleCompact(this.value==='on')">
            <option value="off" selected>Normal</option>
            <option value="on">Compact</option>
          </select>
        </div> -->
        <div class="pill">
          <button id="pinBtn" aria-label="√âpingler la barre" onclick="togglePinButton()" style="font-size:16px;display:flex;align-items:center;gap:6px;">
            <span id="pinEmoji">üìå</span>
            <span id="pinText">√âpingl√©e</span>
          </button>
        </div>
        <div class="pill">
          <label for="csvLocale">Export CSV</label>
          <select id="csvLocale">
            <option value="fr" selected>Semicolon " ; "</option>
            <option value="intl">Comma " , "</option>
          </select>
          <button class="btn" onclick="exportCSV()">Exporter CSV</button>
        </div>
        <div class="pill">
          <a href="#notes" style="text-decoration:none;color:inherit">Notes & Sources</a>
        </div>
      </div>
    </div>
  </div>
  <div id="topbar-spacer" style="height: var(--topbar-h);"></div>

  <header class="container">
    <h1>Entr√©e par <u>CA</u> et charges + Projection pluriannuelle</h1>
    <div class="subtitle">TNS vs SASU-IR vs SASU-IS (salaire + dividendes). SMIC min. 4 trimestres, PFU/bar√®me, projection multi-ann√©es.</div>
  </header>

  <div class="container grid">

    <!-- Param√®tres g√©n√©raux -->
    <section class="card span-12">
      <h2>Param√®tres g√©n√©raux</h2>
      <div class="row">
        <div><label for="startYear">Ann√©e de d√©part</label><input id="startYear" type="number" value="2025" oninput="updateYears()"></div>
        <div><label for="years">Nombre d'ann√©es</label><input id="years" type="number" value="5" oninput="updateYears()"></div>
      </div>
      <div class="row">
        <div><label for="inflation">Inflation / indexation bar√®me IR (% / an)</label><input id="inflation" type="number" step="0.1" value="2" oninput="updateYears()"></div>
        <div><label for="passGrow">Croissance annuelle du PASS (% / an)</label><input id="passGrow" type="number" step="0.1" value="2" oninput="updateYears()"></div>
      </div>
      <div class="row">
        <div><label for="pass">PASS (ann√©e 1, ‚Ç¨/an)</label><input id="pass" type="number" value="47100" oninput="updateYears()"></div>
        <div><label for="cfp">CFP (forfait) ‚Ç¨ ‚Äî TNS</label><input id="cfp" type="number" value="118"></div>
      </div>
    </section>

    <!-- Bloc TNS -->
    <section class="card span-12" id="blocTNS" >
      <h2>EURL / EI √† l‚ÄôIS ‚Äî G√©rant TNS (full r√©mun√©ration)</h2>
      <div class="row">
        <div><label for="ca">CA (ann√©e 1) ‚Ç¨</label><input id="ca" type="number" value="100000"></div>
        <div><label for="caGrow">Croissance CA (% / an)</label><input id="caGrow" type="number" value="5"></div>
      </div>
      <div class="row">
        <div><label for="chargesPct">Charges externes (% du CA)</label><input id="chargesPct" type="number" value="3"></div>
        <div><label for="chargesFixes">Autres charges fixes (‚Ç¨/an, ann√©e 1)</label><input id="chargesFixes" type="number" value="0"></div>
      </div>
      <div class="row">
        <div>
          <label>CSG incluse dans neutralisation IS ?</label>
          <select id="includeCsg"><option value="1" selected>Oui</option><option value="0">Non</option></select>
        </div>
        <div style="display:flex;gap:10px;align-items:end">
          <button type="button" class="btn" onclick="mainCalc(true)">Calculer (TNS ann√©e 1)</button>
          <button class="btn btn-reset subtle" onclick="resetAll()">R√©initialiser</button>
        </div>
      </div>
      <div class="kpi">
        <div class="box"><div class="label">Marge dispo</div><div class="value" id="margeOut">‚Äì</div></div>
        <div class="box"><div class="label">R√©mun√©ration (R)</div><div class="value" id="Rout">‚Äì</div><div id="Rratio" class="muted" style="font-size:12px">‚Äì</div></div>
        <div class="box"><div class="label">Cotis. (hors CSG)</div><div class="value" id="cotHorsCsg">‚Äì</div><div id="cotHorsCsgPct" class="muted" style="font-size:12px">‚Äì</div></div>
        <div class="box"><div class="label">CSG-CRDS</div><div class="value" id="csgOut">‚Äì</div></div>
        <div class="box"><div class="label">Total cotis. TNS</div><div class="value" id="totalTns">‚Äì</div><div id="totalTnsPct" class="muted" style="font-size:12px">‚Äì</div></div>
      </div>
      <div class="hint">Les taux TNS utilis√©s sont des <b>taux effectifs</b> et plafonn√©s par le PASS ; ajustez si vos r√©gimes diff√®rent.</div>
      <h3 style="margin-top:12px">D√©tail cotisations</h3>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Poste</th><th class="num">Montant</th><th class="num">% de R</th></tr></thead>
          <tbody id="tblTns"></tbody>
          <tfoot>
            <tr><th>Total hors CSG</th><th class="num" id="sumHorsCsg">‚Äì</th><th class="num" id="sumHorsCsgPct">‚Äì</th></tr>
            <tr><th>CSG-CRDS</th><th class="num" id="sumCsg">‚Äì</th><th class="num" id="sumCsgPct">‚Äì</th></tr>
            <tr><th>Total cotisations</th><th class="num" id="sumTot">‚Äì</th><th class="num" id="sumTotPct">‚Äì</th></tr>
          </tfoot>
        </table>
      </div>
      <div class="console" id="console"></div>
    </section>

    <!-- Bloc SASU IR -->
    <section class="card span-12" id="blocSASU" style="display:none">
      <h2>SASU √† l‚ÄôIR ‚Äî Transparence</h2>
      <div class="row">
        <div><label for="sasuSalaire">Salaire brut (ann√©e 1) ‚Ç¨</label><input id="sasuSalaire" type="number" value="12000"></div>
        <div><label for="sasuSalaireGrow">Croissance salaire (% / an)</label><input id="sasuSalaireGrow" type="number" value="0"></div>
      </div>
      <div class="row">
        <div><label for="sasuBnc">BNC imposable (ann√©e 1) ‚Ç¨</label><input id="sasuBnc" type="number" value="84000"></div>
        <div><label for="sasuBncGrow">Croissance BNC (% / an)</label><input id="sasuBncGrow" type="number" value="5"></div>
      </div>
      <div class="row">
        <div>
          <label for="psRate">Pr√©l√®vements sociaux sur la quote-part</label>
          <select id="psRate"><option value="0.097" selected>9,7 % (activit√© pro)</option><option value="0.172">17,2 % (patrimoine)</option></select>
        </div>
        <div style="display:flex;gap:10px;align-items:end">
          <button type="button" class="btn" onclick="calcSASU(true)">Calculer (SASU IR ann√©e 1)</button>
          <button class="btn btn-reset subtle" onclick="resetSASU()">R√©init. SASU</button>
        </div>
      </div>

      <div class="kpi">
        <div class="box"><div class="label">Salaire imposable (-10 %)</div><div class="value" id="sasuSalaireImp">‚Äì</div></div>
        <div class="box"><div class="label">PS sur quote-part</div><div class="value" id="sasuPs">‚Äì</div><div id="sasuPsRateText" class="muted" style="font-size:12px">‚Äì</div></div>
        <div class="box"><div class="label">Revenu imposable (sal + BNC)</div><div class="value" id="sasuRni">‚Äì</div></div>
      </div>

      <h3 style="margin-top:12px">D√©tail SASU (IR & encaissements)</h3>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Poste</th><th class="num">Montant</th></tr></thead>
          <tbody id="tblSasu"></tbody>
          <tfoot>
            <tr><th>Total encaissements dirigeant (sal + BNC)</th><th class="num" id="sumSasuEnc">‚Äì</th></tr>
          </tfoot>
        </table>
      </div>
    </section>

    <!-- Bloc SASU IS -->
    <section class="card span-12" id="blocSASUIS" style="display:none">
      <h2>SASU √† l‚ÄôIS ‚Äî Salaire + Dividendes</h2>
      <div class="row">
        <div><label for="sisuCA">CA (ann√©e 1) ‚Ç¨</label><input id="sisuCA" type="number" value="150000"></div>
        <div><label for="sisuCAGrow">Croissance CA (% / an)</label><input id="sisuCAGrow" type="number" value="5"></div>
      </div>
      <div class="row">
        <div><label for="sisuChargesPct">Charges externes (% du CA)</label><input id="sisuChargesPct" type="number" value="3"></div>
        <div><label for="sisuChargesFix">Autres charges fixes (‚Ç¨/an, ann√©e 1)</label><input id="sisuChargesFix" type="number" value="0"></div>
      </div>
      <div class="row">
        <div><label for="smicHour">SMIC horaire brut (ann√©e 1) ‚Ç¨</label><input id="smicHour" type="number" value="11.65" oninput="updateSISUHelper()"></div>
        <div><label for="smicGrow">Croissance SMIC (% / an)</label><input id="smicGrow" type="number" value="2" oninput="updateSISUHelper()"></div>
      </div>
      <div class="row">
        <div>
          <label for="sisuSalaryMode">Salaire</label>
          <select id="sisuSalaryMode" onchange="updateSISUHelper()">
            <option value="manual" selected>Montant brut (manuel)</option>
            <option value="min4q">Salaire minimal pour 4 trimestres</option>
          </select>
        </div>
        <div><label for="sisuSalaire">Salaire brut (ann√©e 1, si manuel) ‚Ç¨</label><input id="sisuSalaire" type="number" value="20000"></div>
      </div>
      <div class="row">
        <div><label for="rateSal">Cotisations salariales (%)</label><input id="rateSal" type="number" value="22"><div class="hint">Taux <b>moyen</b> (assimil√© salari√©). Ajustable selon votre cas.</div></div>
        <div><label for="ratePat">Charges patronales (%)</label><input id="ratePat" type="number" value="42"><div class="hint">Taux <b>moyen</b> (hors exon√©rations). Ajustable.</div></div>
      </div>
      <div class="row">
        <div><label for="isRedThr">Seuil IS r√©duit 15 % (‚Ç¨/an)</label><input id="isRedThr" type="number" value="42500"><div class="hint">Seuil PME √©ligible (CGI art. 219).</div></div>
        <div><label for="isRate">IS taux normal (%)</label><input id="isRate" type="number" value="25"></div>
      </div>
      <div class="row">
        <div><label for="distRate">Distribution dividendes (% du r√©sultat apr√®s IS)</label><input id="distRate" type="number" value="100"></div>
        <div>
          <label for="divMode">Fiscalit√© dividendes</label>
          <select id="divMode">
            <option value="pfu" selected>PFU 12,8 % + PS 17,2 %</option>
            <option value="bareme">Bar√®me (+ abattement 40 %) + PS 17,2 %</option>
          </select>
        </div>
      </div>
      <div class="row" style="margin-top:6px">
        <div style="display:flex;gap:10px;align-items:end">
          <button type="button" class="btn" onclick="calcSISU(true)">Calculer (SASU IS ann√©e 1)</button>
          <div class="hint">‚ÑπÔ∏è Le <b>brut annuel minimal</b> pour <b>4 trimestres</b> = <b>600 √ó SMIC horaire</b>. Voir Notes.</div>
        </div>
      </div>
      <div class="kpi">
        <div class="box"><div class="label">Salaire brut retenu</div><div class="value" id="sisuKpiSal">‚Äì</div><div class="muted" id="sisuMinInfo" style="font-size:12px">‚Äì</div></div>
        <div class="box"><div class="label">R√©sultat imposable IS</div><div class="value" id="sisuKpiRes">‚Äì</div></div>
        <div class="box"><div class="label">IS (total)</div><div class="value" id="sisuKpiIS">‚Äì</div></div>
        <div class="box"><div class="label">Dividendes bruts</div><div class="value" id="sisuKpiDivBrut">‚Äì</div></div>
        <div class="box"><div class="label">Dividendes nets per√ßus</div><div class="value" id="sisuKpiDivNet">‚Äì</div></div>
      </div>

      <h3 style="margin-top:12px">D√©tail SASU IS</h3>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Poste</th><th class="num">Montant</th></tr></thead>
          <tbody id="tblSISU"></tbody>
          <tfoot>
            <tr><th>Encaissements dirigeant (Net salaire + Net dividendes)</th><th class="num" id="sumSISUEnc">‚Äì</th></tr>
          </tfoot>
        </table>
      </div>
    </section>

    <!-- IR + Net dispo (ann√©e 1) -->
    <section class="card span-12">
      <h2>Imp√¥t sur le revenu du foyer + Net dispo (ann√©e 1)</h2>
      <div class="row">
        <div><label for="parts">Nombre de parts</label><input id="parts" type="number" value="2" oninput="calcIR()"></div>
        <div>
          <label for="syncSource">Source salaire imposable</label>
          <select id="syncSource" onchange="syncIR()">
            <option value="tns" selected>TNS (R √ó 90 %)</option>
            <option value="sasu">SASU IR (salaire √ó 90 % + BNC)</option>
            <option value="sasuIS">SASU IS (salaire √ó 90 % + dividendes selon mode)</option>
            <option value="manual">Manuel</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div>
          <h3>Vos revenus √† l'IR</h3>
          <label for="rSal">Salaires imposables (apr√®s -10 %) ‚Ç¨</label><input id="rSal" type="number" value="0" oninput="calcIR()">
          <label for="rBnc">BNC/B√©n√©fices transparents ‚Ç¨</label><input id="rBnc" type="number" value="0" oninput="calcIR()">
          <label for="rDivIR">Dividendes imposables au bar√®me (apr√®s abattement 40 %) ‚Ç¨</label><input id="rDivIR" type="number" value="0" oninput="calcIR()">
          <div class="hint">Le <b>RNI</b> est la base <b>imposable</b> du foyer. Le <b>Net foyer</b> = encaissements (selon mode choisi) ‚àí IR. Ils diff√®rent car le <b>Net</b> est une logique <b>cash</b> (incluant PFU/PS √©ventuels), alors que le <b>RNI</b> suit la logique <b>fiscale</b>.</div>
        </div>
        <div>
          <h3>Conjoint(e) micro-BNC</h3>
          <label for="caSpouse">CA mensuel (ann√©e 1) ‚Ç¨</label><input id="caSpouse" type="number" value="3000" oninput="calcIR()">
          <label for="growth">Croissance annuelle conjoint (%)</label><input id="growth" type="number" value="5" oninput="calcIR()">
          <div class="muted" style="font-size:12px">Base imposable conjointe ‚âà 66 % √ó (CA mensuel √ó 12).</div>
        </div>
      </div>

      <div class="row" style="margin-top:8px">
        <div>
          <label for="deductCsg">D√©duire CSG 6,8 % (TNS) de l'assiette IR ?</label>
          <select id="deductCsg" onchange="calcIR()"><option value="1" selected>Oui</option><option value="0">Non</option></select>
        </div>
        <div>
          <label for="cashOpts">Encaissements √† consid√©rer pour le net</label>
          <select id="cashOpts" onchange="calcIR()">
            <option value="tns_spouse" selected>Dirigeant (TNS) + Conjoint</option>
            <option value="tns_only">Dirigeant seulement (TNS)</option>
            <option value="sasu_bnc_spouse">SASU IR: salaire + BNC + Conjoint</option>
            <option value="sasu_is_spouse">SASU IS: net salaire + net dividendes + Conjoint</option>
          </select>
          <div class="hint">Synchronis√© automatiquement sur le <b>mode principal</b>.</div>
        </div>
      </div>

      <div class="kpi">
        <div class="box"><div class="label">RNI du foyer</div><div class="value" id="rniFoyer">‚Äì</div></div>
        <div class="box"><div class="label">IR estim√© (hors cr√©dits)</div><div class="value" id="irOut">‚Äì</div></div>
        <div class="box"><div class="label">Net dispo (foyer)</div><div class="value" id="netFoyer">‚Äì</div></div>
        <div class="box"><div class="label">TMI estim√©e</div><div class="value" id="tmiOut">‚Äì</div></div>
      </div>

      <h3 style="margin-top:12px">D√©tail IR par tranches</h3>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Tranche</th><th class="num">Base tax√©e</th><th class="num">Taux</th><th class="num">Imp√¥t</th></tr></thead>
          <tbody id="tblIr"></tbody>
          <tfoot>
            <tr><th>Total (par part)</th><th class="num" id="sumBasePart">‚Äì</th><th></th><th class="num" id="sumTaxPart">‚Äì</th></tr>
            <tr><th>Total foyer</th><th class="num" id="sumBaseFoyer">‚Äì</th><th></th><th class="num" id="sumTaxFoyer">‚Äì</th></tr>
          </tfoot>
        </table>
      </div>

      <div class="console" id="consoleIR"></div>
    </section>

    <!-- PROJECTION PLURIANNUELLE -->
    <section class="card span-12">
      <h2>Projection pluriannuelle</h2>
      <div class="row">
        <div class="muted">Bar√®me IR index√© par votre inflation, PASS et SMIC √©volutifs, revenus et param√®tres de chaque mode actualis√©s chaque ann√©e.</div>
        <div style="text-align:right">
          <button type="button" class="btn" onclick="projectYears()">Calculer la projection</button>
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Ann√©e</th><th class="num">PASS</th><th class="num">SMIC h.</th><th>Mode</th>
              <th class="num">CA</th><th class="num">R/Salaire</th><th class="num">BNC</th>
              <th class="num">Div. bruts</th><th class="num">Div. nets</th><th>Mode div.</th>
              <th class="num">Cotis/IS/PS</th><th class="num">RNI foyer</th><th class="num">IR</th><th class="num">Net foyer</th>
            </tr>
          </thead>
          <tbody id="tblProj"></tbody>
          <tfoot>
            <tr>
              <th>Total / Moyenne</th><th></th><th></th><th></th>
              <th class="num" id="pCA">‚Äì</th><th class="num" id="pR">‚Äì</th><th class="num" id="pBNC">‚Äì</th>
              <th class="num" id="pDivB">‚Äì</th><th class="num" id="pDivN">‚Äì</th><th></th>
              <th class="num" id="pCot">‚Äì</th><th class="num" id="pRNI">‚Äì</th><th class="num" id="pIR">‚Äì</th><th class="num" id="pNet">‚Äì</th>
            </tr>
          </tfoot>
        </table>
      </div>
    </section>

    <!-- NOTES -->
    <section class="card span-12" id="notes">
      <h2>Notes & Sources</h2>
      <div class="tabs">
        <div class="tab active" onclick="showNote('howto',this)">Guide d‚Äôutilisation</div>
        <div class="tab" onclick="showNote('params',this)">Param√®tres & hypoth√®ses</div>
        <div class="tab" onclick="showNote('sources',this)">Sources officielles</div>
      </div>
      <div id="noteContent" style="margin-top:10px;line-height:1.6"></div>
    </section>

  </div>

  <script src="script.js" defer></script>
</body>
</html>
