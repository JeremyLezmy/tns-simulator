<!DOCTYPE html>
<html lang="fr" data-theme="auto">
  <head>
    <meta charset="utf-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Simulateur TNS & IR ‚Äì CA ‚Üí R (France) ‚Ä¢ v1.8</title>
    <link rel="stylesheet" href="src/assets/css/base.css" />
    <link rel="stylesheet" href="src/assets/css/layout.css" />
    <link rel="stylesheet" href="src/assets/css/components/topbar.css" />
    <link rel="stylesheet" href="src/assets/css/components/cards.css" />
    <link rel="stylesheet" href="src/assets/css/components/tables.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-sankey"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-treemap"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
  </head>

  <body>
    <div id="floating-controls">
      <button id="themeToggle" class="floating-btn" aria-label="Basculer le th√®me">üåô</button>
      <button id="scrollTopBtn" class="floating-btn hidden" aria-label="Haut de page">‚Üë</button>
    </div>

    <header class="container" style="margin-top: 40px;">
      <h1>Simulateur de Revenus & Charges</h1>
      <div class="subtitle">
        Comparez TNS, SASU (IR/IS), Micro et Salariat. Optimisez votre r√©mun√©ration nette.<br>
        <a href="#notes" class="subtle-link">Notes & Sources</a>
      </div>
    </header>

    <div class="container grid">
      <section class="card span-12" id="blocFoyer">
        <h2>Foyer fiscal & Param√®tres g√©n√©raux</h2>
        <div class="row" style="gap: 16px; align-items: end">
          <div>
            <label for="familyStatus">Statut</label>
            <select id="familyStatus">
              <option value="single" selected>C√©libataire / s√©par√©</option>
              <option value="married">Mari√©(e) / Pacs√©(e)</option>
            </select>
          </div>
          <div>
            <label for="parts">Parts fiscales (auto) <span id="partsHint" class="hint">Calcule automatique des parts</span></label>
            <input id="parts" type="number" value="1" readonly disabled />
          </div>
        </div>

        <div class="row" style="gap: 16px; align-items: end">
          <div>
            <label for="guardMode">Garde</label>
            <select id="guardMode">
              <option value="exclusive" selected>Charge principale / exclusive</option>
              <option value="alternate">Garde altern√©e (simplifi√©e)</option>
            </select>
          </div>
          <div>
            <label for="childrenCount">Nombre d'enfants √† charge</label>
            <input id="childrenCount" type="number" min="0" value="0" />
          </div>
        </div>

        <div class="row">
          <div><label for="startYear">Ann√©e de d√©part</label><input id="startYear" type="number" value="2025" /></div>

          <div><label for="years">Nombre d'ann√©es</label><input id="years" type="number" value="5" /></div>
        </div>

        <div class="row">
          <div>
            <label for="inflation">Inflation / indexation bar√®me IR (% / an)</label><input id="inflation" type="number" step="0.1" value="2" />
          </div>

          <div><label for="passGrow">Croissance annuelle du PASS (% / an)</label><input id="passGrow" type="number" step="0.1" value="2" /></div>
        </div>

        <div class="row">
          <div><label for="pass">PASS (ann√©e 1, ‚Ç¨/an)</label><input id="pass" type="number" value="47100" /></div>

          <div><label for="cfp">CFP (forfait) ‚Ç¨ ‚Äî TNS</label><input id="cfp" type="number" value="118" /></div>
        </div>
      </section>
      <section class="card span-12" id="blocMode">
        <div class="card-tabs">
          <div class="tabs">
            <button type="button" id="tab-d1" class="tab active">D√©clarant 1</button>
            <button type="button" id="tab-d2" class="tab disabled">D√©clarant 2</button>
          </div>
        </div>
        <div class="row" style="align-items: center; justify-content: space-between">
          <div>
            <h2 id="modeTitle">Mode principal du d√©clarant</h2>
            <div class="muted">Chaque d√©clarant garde son mode, ses param√®tres et ses r√©sultats.</div>
          </div>
          <div class="pill">
            <label for="modeSel">Mode de r√©mun√©ration</label>
            <select id="modeSel">
              <option value="tns" selected>EURL/EI √† l‚ÄôIS (TNS)</option>
              <option value="sasuIR">SASU √† l‚ÄôIR (transparence)</option>
              <option value="sasuIS">SASU √† l‚ÄôIS (salaire + dividendes)</option>
              <option value="micro">Micro-entreprise</option>
              <option value="salarie">Salariat</option>
            </select>
          </div>
        </div>
      </section>

      <section class="card span-12" id="blocTNS">
        <h2>EURL / EI √† l‚ÄôIS ‚Äî G√©rant TNS (full r√©mun√©ration)</h2>

        <div class="row">
          <div><label for="ca">CA (ann√©e 1) ‚Ç¨</label><input id="ca" type="number" value="100000" step="1000" /></div>

          <div><label for="caGrow">Croissance CA (% / an)</label><input id="caGrow" type="number" value="5" /></div>
        </div>

        <div class="row">
          <div><label for="chargesPct">Charges externes (% du CA)</label><input id="chargesPct" type="number" value="3" /></div>

          <div><label for="chargesFixes">Autres charges fixes (‚Ç¨/an, ann√©e 1)</label><input id="chargesFixes" type="number" value="0" /></div>
        </div>

        <div class="row">
          <div>
            <label>
              Inclure CSG/CRDS dans les charges ?
              <div class="help-container">
                <div class="help-icon">?</div>
                <div class="help-bubble">
                  Si "Oui", la CSG/CRDS est consid√©r√©e comme une charge professionnelle et d√©duite du r√©sultat (diminuant le RNI).<br>
                  Si "Non", elle est pay√©e personnellement (augmentant le RNI).<br>
                  En g√©n√©ral, pour une soci√©t√© √† l'IS, c'est "Oui".
                </div>
              </div>
            </label>
            <select id="includeCsg">
              <option value="1" selected>Oui</option>

              <option value="0">Non</option>
            </select>
          </div>

          <div>
            <label>
              D√©duire CSG (6.8%) du revenu imposable ?
              <div class="help-container">
                <div class="help-icon" data-target="deductCsgHint">?</div>
                <div class="help-bubble" id="deductCsgHint">
                  <!-- Will be populated by JS -->
                </div>
              </div>
            </label>
            <select id="deductCsg">
              <option value="1" selected>Oui</option>

              <option value="0">Non</option>
            </select>
          </div>

          <div style="display: flex; gap: 10px; align-items: end; margin-bottom: 8px">
            <button id="calcTnsBtn" type="button" class="btn">Calculer</button>
            <button id="resetTnsBtn" class="btn btn-reset subtle">Reset</button>
          </div>
        </div>

        <div class="kpi">
          <div class="box">
            <div class="label">Marge dispo</div>

            <div class="value" id="margeOut">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">R√©mun√©ration (R)</div>

            <div class="value" id="Rout">‚Äì</div>

            <div id="Rratio" class="muted" style="font-size: 12px">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Cotis. (hors CSG)</div>

            <div class="value" id="cotHorsCsg">‚Äì</div>

            <div id="cotHorsCsgPct" class="muted" style="font-size: 12px">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">CSG-CRDS</div>

            <div class="value" id="csgOut">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Total cotis. TNS</div>

            <div class="value" id="totalTns">‚Äì</div>

            <div id="totalTnsPct" class="muted" style="font-size: 12px">‚Äì</div>
          </div>
        </div>

        <h3 style="margin-top: 12px">D√©tail cotisations <span class="hint">Les taux TNS utilis√©s sont des <b>taux effectifs</b> et plafonn√©s par le PASS ; ajustez si vos r√©gimes diff√®rent.</span></h3>

        <div style="display: flex; gap: 8px; margin-bottom: 8px">
          <button type="button" class="btn btn-secondary active" id="btnViewTnsDetail" onclick="toggleTnsView('detail')">D√©tail</button>
          <button type="button" class="btn btn-secondary" id="btnViewTnsVisual" onclick="toggleTnsView('visual')">Visuels</button>
        </div>

        <div id="tnsDetailWrapper" class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Poste</th>

                <th class="num">Montant</th>

                <th class="num">% de R</th>
              </tr>
            </thead>

            <tbody id="tblTns"></tbody>

            <tfoot>
              <tr>
                <th>Total hors CSG</th>

                <th class="num" id="sumHorsCsg">‚Äì</th>

                <th class="num" id="sumHorsCsgPct">‚Äì</th>
              </tr>

              <tr>
                <th>CSG-CRDS</th>

                <th class="num" id="sumCsg">‚Äì</th>

                <th class="num" id="sumCsgPct">‚Äì</th>
              </tr>

              <tr>
                <th>Total cotisations</th>

                <th class="num" id="sumTot">‚Äì</th>

                <th class="num" id="sumTotPct">‚Äì</th>
              </tr>
            </tfoot>
          </table>
        </div>

        <div id="tnsVisualWrapper" style="display: none;">
          <div class="charts-container">
            <div class="chart-wrapper">
              <canvas id="chartTns1"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartTns2"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartTns3"></canvas>
              <div class="chart-hint-overlay">
                <div class="help-container" style="position: absolute; top: 10px; right: 10px;">
                  <div class="help-icon">?</div>
                  <div class="help-bubble" style="right: 0; left: auto; width: 250px;">
                    <strong>Regroupements :</strong><br>
                    ‚Ä¢ Retraite = Base + Compl√©mentaire (RCI)<br>
                    ‚Ä¢ Sant√© = Maladie + Indemnit√©s Journali√®res<br>
                    ‚Ä¢ Pr√©voyance = Invalidit√© / D√©c√®s
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- <div class="console" id="console"></div> -->
      </section>

      <section class="card span-12" id="blocSASU" style="display: none">
        <h2>SASU √† l‚ÄôIR ‚Äî Transparence</h2>

        <div class="row">
          <div><label for="sasuSalaire">Salaire brut (ann√©e 1) ‚Ç¨</label><input id="sasuSalaire" type="number" value="12000" /></div>

          <div><label for="sasuSalaireGrow">Croissance salaire (% / an)</label><input id="sasuSalaireGrow" type="number" value="0" /></div>
        </div>

        <div class="row">
          <div><label for="sasuBnc">BNC imposable (ann√©e 1) ‚Ç¨</label><input id="sasuBnc" type="number" value="84000" /></div>

          <div><label for="sasuBncGrow">Croissance BNC (% / an)</label><input id="sasuBncGrow" type="number" value="5" /></div>
        </div>

        <div class="row">
          <div>
            <label for="psRate">Pr√©l√®vements sociaux sur la quote-part</label>
            <select id="psRate">
              <option value="0.097" selected>9,7 % (activit√© pro)</option>

              <option value="0.172">17,2 % (patrimoine)</option>
            </select>
          </div>

          <div style="display: flex; gap: 10px; align-items: end; margin-bottom: 8px">
            <button id="calcSasuIrBtn" type="button" class="btn">Calculer</button>
            <button id="resetSasuIrBtn" class="btn btn-reset subtle">Reset</button>
          </div>
        </div>

        <div class="kpi">
          <div class="box">
            <div class="label">Salaire imposable (-10 %)</div>

            <div class="value" id="sasuSalaireImp">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">PS sur quote-part</div>

            <div class="value" id="sasuPs">‚Äì</div>
          </div>
        </div>
        <h3 style="margin-top: 12px">D√©tail SASU (IR & encaissements)</h3>

        <div style="display: flex; gap: 8px; margin-bottom: 8px">
          <button type="button" class="btn btn-secondary active" id="btnViewSasuIRDetail" onclick="toggleSasuIRView('detail')">D√©tail</button>
          <button type="button" class="btn btn-secondary" id="btnViewSasuIRVisual" onclick="toggleSasuIRView('visual')">Visuels</button>
        </div>

        <div id="sasuIRDetailWrapper" class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Poste</th>

                <th class="num">Montant</th>
              </tr>
            </thead>

            <tbody id="tblSasu"></tbody>

            <tfoot>
              <tr>
                <th>Total encaissements dirigeant (sal + BNC)</th>

                <th class="num" id="sumSasuEnc">‚Äì</th>
              </tr>
            </tfoot>
          </table>
        </div>

        <div id="sasuIRVisualWrapper" style="display: none;">
          <div class="charts-container">
            <div class="chart-wrapper">
              <canvas id="chartSasuIR1"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartSasuIR2"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="card span-12" id="blocSASUIS" style="display: none">
        <h2>SASU √† l‚ÄôIS ‚Äî Salaire + Dividendes</h2>

        <div class="row">
          <div><label for="sisuCA">CA (ann√©e 1) ‚Ç¨</label><input id="sisuCA" type="number" value="100000" step="1000" /></div>

          <div><label for="sisuCAGrow">Croissance CA (% / an)</label><input id="sisuCAGrow" type="number" value="5" /></div>
        </div>

        <div class="row">
          <div><label for="sisuChargesPct">Charges externes (% du CA)</label><input id="sisuChargesPct" type="number" value="3" /></div>

          <div><label for="sisuChargesFix">Autres charges fixes (‚Ç¨/an, ann√©e 1)</label><input id="sisuChargesFix" type="number" value="0" /></div>
        </div>

        <div class="row">
          <div><label for="smicHour">SMIC horaire brut (ann√©e 1) ‚Ç¨</label><input id="smicHour" type="number" value="11.65" /></div>

          <div><label for="smicGrow">Croissance SMIC (% / an)</label><input id="smicGrow" type="number" value="2" /></div>
        </div>

        <div class="row">
          <div>
            <label for="sisuSalaryMode">Salaire <span class="hint">‚ÑπÔ∏è Le <b>brut annuel minimal</b> pour <b>4 trimestres</b> = <b>600 √ó SMIC horaire</b>. Voir Notes.</span></label>
            <select id="sisuSalaryMode">
              <option value="manual">Montant brut (manuel)</option>

              <option value="min4q" selected>Salaire minimal pour 4 trimestres</option>
            </select>
          </div>

          <div>
            <label for="sisuSalaire">Salaire brut (ann√©e 1, si manuel) ‚Ç¨</label><input id="sisuSalaire" type="number" value="20000" step="1000" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="rateSal">Cotisations salariales (%) <span class="hint">Taux effectif calcul√© (assimil√© salari√©).</span></label> <input id="rateSal" type="number" value="0" disabled />
          </div>

          <div>
            <label for="ratePat">Charges patronales (%) <span class="hint">Taux effectif calcul√© (hors exon√©rations).</span></label> <input id="ratePat" type="number" value="0" disabled />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="isRedThr">Seuil IS r√©duit 15 % (‚Ç¨/an) <span class="hint">Seuil PME √©ligible (CGI art. 219).</span></label><input id="isRedThr" type="number" value="42500" />
          </div>

          <div><label for="isRate">IS taux normal (%)</label><input id="isRate" type="number" value="25" /></div>
        </div>

        <div class="row">
          <div><label for="distRate">Distribution dividendes (% du r√©sultat apr√®s IS)</label><input id="distRate" type="number" value="100" /></div>

          <div>
            <label for="divMode">Fiscalit√© dividendes</label>
            <select id="divMode">
              <option value="pfu" selected>PFU 12,8 % + PS 17,2 %</option>

              <option value="bareme">Bar√®me (+ abattement 40 %) + PS 17,2 %</option>
            </select>
          </div>
        </div>

        <div class="row" style="margin-top: 6px">
          <div style="display: flex; gap: 10px; align-items: end; margin-bottom: 8px">
            <button id="calcSisuBtn" type="button" class="btn">Calculer</button>
            <button class="btn btn-reset subtle" id="resetSISUBtn" type="button">Reset SASU-IS</button>
          </div>
        </div>

        <div class="kpi">
          <div class="box">
            <div class="label">Salaire brut retenu</div>

            <div class="value" id="sisuKpiSal">‚Äì</div>

            <div class="muted" id="sisuMinInfo" style="font-size: 12px">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">R√©sultat imposable IS</div>

            <div class="value" id="sisuKpiRes">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">IS (total)</div>

            <div class="value" id="sisuKpiIS">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Dividendes bruts</div>

            <div class="value" id="sisuKpiDivBrut">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Dividendes nets per√ßus</div>

            <div class="value" id="sisuKpiDivNet">‚Äì</div>
          </div>
        </div>

        <h3 style="margin-top: 12px">D√©tail SASU √† l'IS</h3>

        <div style="display: flex; gap: 8px; margin-bottom: 8px">
          <button type="button" class="btn btn-secondary active" id="btnViewGlobal" onclick="toggleSisuView('global')">Vue synth√®se</button>
          <button type="button" class="btn btn-secondary" id="btnViewCharges" onclick="toggleSisuView('charges')">D√©tail charges r√©mun√©ration dirigeant</button>
          <button type="button" class="btn btn-secondary" id="btnViewVisual" onclick="toggleSisuView('visual')">Visuels</button>
        </div>

        <div class="table-wrapper" id="tblSISUWrapper">
          <table>
            <thead>
              <tr>
                <th>Poste</th>

                <th class="num">Montant</th>
              </tr>
            </thead>

            <tbody id="tblSISU"></tbody>

            <tfoot>
              <tr>
                <th>Encaissements dirigeant (Net salaire + Net dividendes)</th>

                <th class="num" id="sumSISUEnc">‚Äì</th>
              </tr>
            </tfoot>
          </table>
        </div>

        <div class="table-wrapper" id="tblSISUChargesWrapper" style="display: none">
          <table id="tblSISUCharges" class="detail-cotisations">
            <thead>
              <tr>
                <th>Poste</th>

                <th class="num">Base</th>

                <th class="num">Tauxch.salariales(%)</th>

                <th class="num">Montantch.salariales(‚Ç¨)</th>

                <th class="num">Tauxch.patronales(%)</th>

                <th class="num">Montantch.patronales(‚Ç¨)</th>
              </tr>
            </thead>

            <tbody></tbody>

            <tfoot>
              <tr class="summary">
                <td>Total</td>

                <td class="num" id="sisuCharges-base">‚Äì</td>

                <td class="num" id="sisuCharges-sal-pct">‚Äì</td>

                <td class="num" id="sisuCharges-sal-mt">‚Äì</td>

                <td class="num" id="sisuCharges-emp-pct">‚Äì</td>

                <td class="num" id="sisuCharges-emp-mt">‚Äì</td>
              </tr>
            </tfoot>
          </table>
        </div>

        <div id="sisuVisualWrapper" style="display: none;">
          <div class="charts-container">
            <div class="chart-wrapper">
              <canvas id="chartSasuIS1"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartSasuIS2"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartSasuIS3"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartSasuIS4"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="card span-12" id="blocMICRO" style="display: none">
        <h2>Micro-entreprise</h2>

        <div class="row">
          <div><label for="microCA">CA (ann√©e 1) ‚Ç¨</label> <input id="microCA" type="number" value="70000" step="1000" /></div>

          <div><label for="microGrow">Croissance CA (% / an)</label> <input id="microGrow" type="number" value="5" /></div>
        </div>

        <div class="row">
          <div>
            <label for="microActivity">Type d‚Äôactivit√© <span class="hint">Les seuils de CA annuels diff√®rent selon la nature de l‚Äôactivit√©. ÓÑÅ Voir Notes.<br />
            Abattement forfaitaire : 71 % commerce, 50 % services, 34 % BNC/CIPAV.</span></label>
            <select id="microActivity">
              <option value="service">Prestations commerciales / artisanales (BIC)‚Äì 21,2‚ÄØ%</option>

              <option value="bnc" selected>Prof. lib√©rales non r√©glement√©es(BNC)‚Äì26,1‚ÄØ%</option>

              <option value="cipav">Prof. lib√©rales r√©glement√©es (CIPAV)‚Äì23,2‚ÄØ%</option>

              <option value="commerce">Vente de marchandises / h√©bergement‚Äì12,3‚ÄØ%</option>
            </select>

            <label style="margin-top: 12px; display: flex; align-items: center; gap: 6px;"><input type="checkbox" id="microACRE" /> B√©n√©ficie de l‚ÄôACRE (ann√©e1) <span class="hint">R√©duction de 50‚ÄØ% des cotisations la 1<sup>√®re</sup> ann√©e.</span></label>
          </div>

          <div style="display: flex; gap: 10px; align-items: end; margin-bottom: 8px">
            <button id="calcMicroBtn" type="button" class="btn">Calculer</button>
            <button id="resetMicroBtn" class="btn btn-reset subtle">Reset</button>
          </div>
        </div>

        <div class="kpi">
          <div class="box">
            <div class="label">CA retenu</div>

            <div class="value" id="microKpiCA">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Statut de seuil <span id="microWarningDetail" class="hint"></span></div>

            <div class="value" id="microWarning">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Total cotisations</div>

            <div class="value" id="microKpiCot">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">R√©mun√©ration nette</div>

            <div class="value" id="microKpiRem">‚Äì</div>
          </div>
        </div>

        <h3>D√©tail des cotisations</h3>

        <div style="display: flex; gap: 8px; margin-bottom: 8px">
          <button type="button" class="btn btn-secondary active" id="btnViewMicroDetail" onclick="toggleMicroView('detail')">D√©tail</button>
          <button type="button" class="btn btn-secondary" id="btnViewMicroVisual" onclick="toggleMicroView('visual')">Visuels</button>
        </div>

        <div id="microDetailWrapper" class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Poste</th>

                <th class="num">%‚ÄØCA</th>

                <th class="num">Montant</th>
              </tr>
            </thead>

            <tbody id="tblMicro"></tbody>

            <tfoot>
              <tr>
                <th>Total</th>

                <th class="num" id="sumMicroPct">‚Äì</th>

                <th class="num" id="sumMicroTot">‚Äì</th>
              </tr>
            </tfoot>
          </table>
        </div>

        <div id="microVisualWrapper" style="display: none;">
          <div class="charts-container">
            <div class="chart-wrapper">
              <canvas id="chartMicro1"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartMicro2"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="card span-12" id="blocSALARIE" style="display: none">
        <h2>Salariat</h2>

        <div class="row">
          <div>
            <label for="salaireBrut">Salaire brut annuel (‚Ç¨)</label>
            <input id="salaireBrut" type="number" value="50000" step="1000" />
          </div>

          <div>
            <label for="salaireMode">Mode de saisie</label>
            <select id="salaireMode">
              <option value="annuel" selected>Brut annuel</option>

              <option value="mensuel">Brut mensuel √ó12</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div><label for="salaireGrow">Croissance salaire (%‚ÄØ/‚ÄØan)</label> <input id="salaireGrow" type="number" value="3" /></div>
        </div>

        <div class="row">
          <div>
            <label for="variablePct">Variable (% du brut)</label>
            <input id="variablePct" type="number" value="0" step="0.1" />
          </div>

          <div><label for="variableFixe">Variable fixe annuelle (‚Ç¨)</label> <input id="variableFixe" type="number" value="0" /></div>
        </div>

        <div class="row">
          <div>
            <label for="tauxSalarial">Cotisations salariales (%) <span class="hint">Taux moyen assimil√© salari√© (calcul√©).</span></label>
            <input id="tauxSalarial" type="number" value="22" disabled />
          </div>

          <div>
            <label for="tauxPatronal">Cotisations patronales (%) <span class="hint">Co√ªt employeur moyen (calcul√©).</span></label>
            <input id="tauxPatronal" type="number" value="42" disabled />
          </div>
        </div>

        <div>
          <label for="statutSal">Statut</label>
          <select id="statutSal">
            <option value="noncadre" selected>Non-cadre</option>

            <option value="cadre">Cadre</option>
          </select>
        </div>

        <div style="display: flex; gap: 10px; align-items: end; margin-top: 10px">
          <button id="calcSalarieBtn" type="button" class="btn">Calculer</button>
          <button id="resetSalarieBtn" class="btn btn-reset subtle">Reset</button>
        </div>

        <div class="kpi" style="margin-top: 12px">
          <div class="box">
            <div class="label">Salaire brut retenu</div>

            <div class="value" id="salBrutKpi">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Charges salariales</div>

            <div class="value" id="salChargesSalariales">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Charges patronales</div>

            <div class="value" id="salChargesPatronales">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Super brut (co√ªt employeur)</div>

            <div class="value" id="salSuperBrut">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Net dirigeant (avant IR)</div>

            <div class="value" id="salNet">‚Äì</div>
          </div>
        </div>

        <h3>D√©tail des cotisations (salari√© / employeur)</h3>

        <div style="display: flex; gap: 8px; margin-bottom: 8px">
          <button type="button" class="btn btn-secondary active" id="btnViewSalarieDetail" onclick="toggleSalarieView('detail')">D√©tail</button>
          <button type="button" class="btn btn-secondary" id="btnViewSalarieVisual" onclick="toggleSalarieView('visual')">Visuels</button>
        </div>

        <div id="salarieDetailWrapper" class="table-wrapper">
          <table id="tblSalariatDetail" class="detail-cotisations">
            <col style="width: 13%" />
              <col style="width: 10%" />
              <col style="width: 13%" />
            </colgroup>
            <thead>
              <tr>
                <th>Poste</th>
                <th class="num">Base</th>
                <th class="num">Tauxch. salariales (%)</th>
                <th class="num">Montantch. salariales (‚Ç¨)</th>
                <th class="num">Tauxch. patronales (%)</th>
                <th class="num">Montant ch.patronales (‚Ç¨)</th>
              </tr>
            </thead>
            <tbody></tbody>
            <tfoot>
              <tr class="summary">
                <td>Total</td>
                <td class="num" id="total-base">Brut</td>
                <td class="num" id="total-sal-pct">‚Äì</td>
                <td class="num" id="total-sal-mt">‚Äì</td>
                <td class="num" id="total-emp-pct">‚Äì</td>
                <td class="num" id="total-emp-mt">‚Äì</td>
              </tr>
            </tfoot>
          </table>
        </div>

        <div id="salarieVisualWrapper" style="display: none;">
          <div class="charts-container">
            <div class="chart-wrapper">
              <canvas id="chartSalarie1"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartSalarie2"></canvas>
            </div>
            <div class="chart-wrapper">
              <canvas id="chartSalarie3"></canvas>
            </div>
          </div>
        </div>
      </section>

      <section class="card span-12">
        <h2>Imp√¥t sur le revenu du foyer + Net dispo (ann√©e 1)</h2>

        <div class="row">
          <div>
            <h3>Vos revenus √† l'IR</h3>
            <label id="lblRSal" for="rSal">Salaires imposables (apr√®s -10 %) ‚Ç¨</label><input id="rSal" type="number" value="0" />
            <label for="rBnc">BNC/B√©n√©fices transparents ‚Ç¨</label><input id="rBnc" type="number" value="0" />
            <div id="rBncHint" class="hint" style="display: none"></div>
            <label for="rDivIR">Dividendes imposables au bar√®me (apr√®s abattement 40 %) ‚Ç¨</label><input id="rDivIR" type="number" value="0" />
            <div class="hint">Laissez 0 si vous ne percevez ni BNC transparents ni dividendes au bar√®me.</div>
          </div>

          <div>
            <h3>Options & d√©ductions</h3>
            <label for="chargesDeduct">Charges d√©ductibles du revenu global (PER, etc.) ‚Ç¨</label
            ><input id="chargesDeduct" type="number" value="0" />
            <div class="hint">
              Le <b>RNI</b> est la base <b>imposable</b> du foyer. Le <b>Net foyer</b> = encaissements (d√©clarants actifs) ‚àí IR. Ils diff√®rent car le
              <b>Net</b> est une logique <b>cash</b>, alors que le <b>RNI</b> suit la logique <b>fiscale</b>.
            </div>
          </div>
        </div>

        <div class="kpi">
          <div class="box">
            <div class="label">RNI du foyer</div>

            <div class="value" id="rniFoyer">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">IR estim√© (hors cr√©dits)</div>

            <div class="value" id="irOut">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">Net dispo (foyer)</div>

            <div class="value" id="netFoyer">‚Äì</div>
          </div>

          <div class="box">
            <div class="label">TMI estim√©e</div>

            <div class="value" id="tmiOut">‚Äì</div>
          </div>
        </div>

        <h3 style="margin-top: 12px">D√©tail IR par tranches</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Tranche</th>

                <th class="num">Base tax√©e</th>

                <th class="num">Taux</th>

                <th class="num">Imp√¥t</th>
              </tr>
            </thead>

            <tbody id="tblIr"></tbody>

            <tfoot>
              <tr>
                <th>Total (par part)</th>

                <th class="num" id="sumBasePart">‚Äì</th>

                <th></th>

                <th class="num" id="sumTaxPart">‚Äì</th>
              </tr>

              <tr>
                <th>Total foyer</th>

                <th class="num" id="sumBaseFoyer">‚Äì</th>

                <th></th>

                <th class="num" id="sumTaxFoyer">‚Äì</th>
              </tr>
            </tfoot>
          </table>
        </div>

        <!-- New KPI for Net Avant Impots -->
        <div class="kpi" style="margin-top: 16px; justify-content: flex-start; gap: 24px; ">
          <div class="kpi-item" style="background: var(--soft); padding: 10px 16px; border-radius: 12px; border: 1px solid var(--border); box-shadow: 0 2px 8px var(--shadow);">
            <div class="label" style="color: var(--accent); font-weight: 600;">Revenus Net avant Imp√¥ts</div>
            <div class="value" id="netAvantIrFoyer" style="font-size: 24px; color: var(--text);">0 ‚Ç¨</div>
            <div class="sub" id="netAvantIrFoyerSub"></div>
          </div>
        </div>

        <!-- <div class="console" id="consoleIR"></div> -->
      </section>

      <section class="card span-12">
        <h2>Projection pluriannuelle</h2>

        <div class="muted" style="margin-bottom: 16px">
          Bar√®me IR index√© par votre inflation, PASS et SMIC √©volutifs, revenus et param√®tres de chaque mode actualis√©s chaque ann√©e.
        </div>

        <div class="card-tabs">
          <div class="tabs">
            <button type="button" id="projTabFoyer" class="tab active">Foyer</button>
            <button type="button" id="projTabD1" class="tab">D√©clarant 1</button>
            <button type="button" id="projTabD2" class="tab disabled">D√©clarant 2</button>
          </div>
          <div class="muted" style="margin-top: 8px; font-size: 12px;">Choisissez la vue : foyer agr√©g√©, ou un d√©clarant seul.</div>
        </div>

        <div style="text-align: left; margin-bottom: 20px">
          <button id="projectYearsBtn" type="button" class="btn">Calculer la projection</button>
        </div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr id="projHeaderRow"></tr>
            </thead>

            <tbody id="tblProj"></tbody>

            <tfoot id="projFooter"></tfoot>
          </table>
        </div>
      </section>

      <section class="card span-12" id="notes">
        <h2>Notes & Sources</h2>
        <div id="notes-tabs" class="tabs">
          <button type="button" class="tab btn btn-secondary active" data-note="howto">Guide d‚Äôutilisation</button>
          <button type="button" class="tab btn btn-secondary" data-note="params">Param√®tres & hypoth√®ses</button>
          <button type="button" class="tab btn btn-secondary" data-note="sources">Sources officielles</button>
        </div>
        <div id="noteContent" style="margin-top: 10px; line-height: 1.6"></div>
      </section>
    </div>

    <script type="module" src="src/main.js" defer></script>
  </body>
</html>
